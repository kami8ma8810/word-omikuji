# ã€Œä¸€èªç¦å¼•ã€é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

## ç›®æ¬¡
1. [é–‹ç™ºå“²å­¦](#1-é–‹ç™ºå“²å­¦)
2. [TDDï¼ˆãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼‰](#2-tddãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º)
3. [ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ–¹é‡](#3-ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ–¹é‡)
4. [ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°åŸå‰‡](#4-ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°åŸå‰‡)
5. [ã‚³ãƒŸãƒƒãƒˆæ–¹é‡](#5-ã‚³ãƒŸãƒƒãƒˆæ–¹é‡)
6. [ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ç’°å¢ƒ](#6-ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ç’°å¢ƒ)
7. [è¿½åŠ ã®é–‹ç™ºãƒ«ãƒ¼ãƒ«](#7-è¿½åŠ ã®é–‹ç™ºãƒ«ãƒ¼ãƒ«)
8. [åˆå¿ƒè€…å‘ã‘è§£èª¬](#8-åˆå¿ƒè€…å‘ã‘è§£èª¬)

---

## 1. é–‹ç™ºå“²å­¦

### åŸºæœ¬æ–¹é‡
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€**å“è³ªé‡è¦–ãƒ»æ®µéšçš„æˆé•·**ã‚’é‡è¦–ã—ã¾ã™ã€‚

- âœ… **å‹•ãã‚³ãƒ¼ãƒ‰ã‚ˆã‚Šã€æ­£ã—ãå‹•ãã‚³ãƒ¼ãƒ‰**
- âœ… **æ—©ãå®Œæˆã•ã›ã‚‹ã‚ˆã‚Šã€ç¢ºå®Ÿã«å‹•ä½œã™ã‚‹ã‚‚ã®ã‚’ä½œã‚‹**
- âœ… **å¾Œã§ç›´ã™ã‚ˆã‚Šã€æœ€åˆã‹ã‚‰è¨­è¨ˆã™ã‚‹**
- âœ… **è¤‡é›‘ã«ãªã‚‹å‰ã«ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**

### å¯¾è±¡è€…ã¸ã®é…æ…®
ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€**ã‚¸ãƒ¥ãƒ‹ã‚¢ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢**å‘ã‘ã«ï¼š
- è¨­è¨ˆãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç³»ã®å®Ÿè£…ã«ã¯**è©³ç´°ãªã‚³ãƒ¡ãƒ³ãƒˆ**ã‚’è¨˜è¼‰
- ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒã«ã¯**ã‚ã‹ã‚Šã‚„ã™ã„èª¬æ˜**ã‚’ä»˜ä¸
- ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å„å±¤ã®**å½¹å‰²ã‚’æ˜è¨˜**
- å®Ÿè£…å‰ã«**ãªãœãã®è¨­è¨ˆã«ã—ãŸã‹**ã‚’èª¬æ˜
- Reactåˆå¿ƒè€…ã«ã‚‚ã‚ã‹ã‚Šã‚„ã™ãã€Reactç‰¹æœ‰ã®å‡¦ç†ã®èª¬æ˜ã‚’è¨˜è¼‰
- æœ€æ–°ã®Reactã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„Tipsã‚’å¸¸ã«å‚ç…§ã—ãªãŒã‚‰ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è‰¯ã„å‡¦ç†ã‚’é¸æŠ
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºï¼ˆHono + Prismaï¼‰ã«ã¤ã„ã¦ã‚‚**åˆå¿ƒè€…å‘ã‘ã«ä¸å¯§ã«è§£èª¬**
- REST APIã®è¨­è¨ˆã¨ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã®é€£æºæ–¹æ³•ã‚’æ˜è¨˜

---

## 2. TDDï¼ˆãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼‰

### t-wadaæ°ã®TDD
t-wadaæ°ï¼ˆå’Œç”°å“äººæ°ï¼‰ãŒæå”±ã™ã‚‹TDDã‚µã‚¤ã‚¯ãƒ«ã«å¾“ã„ã¾ã™ã€‚

#### TDDã®åŸºæœ¬ã‚µã‚¤ã‚¯ãƒ«ï¼šRed â†’ Green â†’ Refactor

```
ğŸ”´ Redï¼ˆãƒ¬ãƒƒãƒ‰ï¼‰: å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
  â†“
ğŸŸ¢ Greenï¼ˆã‚°ãƒªãƒ¼ãƒ³ï¼‰: ãƒ†ã‚¹ãƒˆãŒé€šã‚‹æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
  â†“
ğŸ”µ Refactorï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼‰: ã‚³ãƒ¼ãƒ‰ã‚’ç¶ºéº—ã«ã™ã‚‹
  â†“
ğŸ”„ ç¹°ã‚Šè¿”ã™
```

### å®Ÿè·µä¾‹ï¼šæŠ•ç¥¨æ©Ÿèƒ½ã®TDD

#### ã‚¹ãƒ†ãƒƒãƒ—1: ğŸ”´ å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
```typescript
// tests/usecases/SubmitKnowledge.test.ts
import { describe, it, expect } from 'vitest';
import { SubmitKnowledge } from '@/domain/usecases/SubmitKnowledge';

describe('SubmitKnowledge', () => {
  it('ã€ŒçŸ¥ã£ã¦ã‚‹ã€æŠ•ç¥¨ã‚’è¨˜éŒ²ã§ãã‚‹', async () => {
    // Arrange: ãƒ†ã‚¹ãƒˆæº–å‚™
    const mockKnowledgeRepo = createMockKnowledgeRepository();
    const mockVoteApiClient = createMockVoteApiClient();
    const usecase = new SubmitKnowledge(mockKnowledgeRepo, mockVoteApiClient);
    const entry = { id: 'word-123', word: 'çŒ«', reading: 'ã­ã“', definition: 'å‹•ç‰©', language: 'ja' as const };
    
    // Act: å®Ÿè¡Œ
    await usecase.execute(entry, true); // true = çŸ¥ã£ã¦ã‚‹
    
    // Assert: æ¤œè¨¼
    const myKnowledge = await mockKnowledgeRepo.find('word-123');
    expect(myKnowledge?.knows).toBe(true);
    expect(mockVoteApiClient.submitVote).toHaveBeenCalledWith('word-123', true);
  });
  
  it('ã™ã§ã«æŠ•ç¥¨æ¸ˆã¿ã®èªã¯æŠ•ç¥¨ã§ããªã„', async () => {
    const mockKnowledgeRepo = createMockKnowledgeRepository();
    mockKnowledgeRepo.add({ wordId: 'word-123', knows: true, votedAt: Date.now(), word: 'çŒ«', definition: 'å‹•ç‰©' });
    
    const usecase = new SubmitKnowledge(mockKnowledgeRepo, createMockVoteApiClient());
    const entry = { id: 'word-123', word: 'çŒ«', reading: 'ã­ã“', definition: 'å‹•ç‰©', language: 'ja' as const };
    
    await expect(usecase.execute(entry, false)).rejects.toThrow('ã™ã§ã«æŠ•ç¥¨æ¸ˆã¿ã§ã™');
  });
});
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: ğŸŸ¢ æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ã§é€šã™
```typescript
// domain/usecases/SubmitKnowledge.ts
export class SubmitKnowledge {
  async execute(entry: VocabularyEntry, knows: boolean): Promise<void> {
    // ã¨ã‚Šã‚ãˆãšé€šã‚‹ã ã‘ã®æœ€å°å®Ÿè£…
    // TODO: ãƒªãƒã‚¸ãƒˆãƒªã«ä¿å­˜ï¼‹APIé€ä¿¡ã‚’è¿½åŠ 
  }
}
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: ğŸ”µ ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
```typescript
// domain/usecases/SubmitKnowledge.ts
export class SubmitKnowledge {
  constructor(
    private knowledgeRepository: IKnowledgeRepository,
    private voteApiClient: IVoteApiClient
  ) {}

  async execute(entry: VocabularyEntry, knows: boolean): Promise<void> {
    // é‡è¤‡æŠ•ç¥¨ãƒã‚§ãƒƒã‚¯
    const existing = await this.knowledgeRepository.find(entry.id);
    if (existing) {
      throw new Error('ã™ã§ã«æŠ•ç¥¨æ¸ˆã¿ã§ã™');
    }

    // ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜
    await this.knowledgeRepository.add({
      wordId: entry.id,
      word: entry.word,
      reading: entry.reading,
      definition: entry.definition,
      knows,
      votedAt: Date.now()
    });

    // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«æŠ•ç¥¨ã‚’é€ä¿¡ï¼ˆåŒ¿åï¼‰
    await this.voteApiClient.submitVote(entry.id, knows);
  }
}
```

### TDDå®Ÿè·µã®ãƒã‚¤ãƒ³ãƒˆ
- âš¡ **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ**: ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã«ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
- ğŸ“ **ä»•æ§˜ã®æ˜ç¢ºåŒ–**: ãƒ†ã‚¹ãƒˆãŒä»•æ§˜æ›¸ã®å½¹å‰²ã‚’æœãŸã™
- ğŸ”’ **ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³é˜²æ­¢**: å¤‰æ›´æ™‚ã®æ—¢å­˜æ©Ÿèƒ½ã®ç ´å£Šã‚’é˜²ã
- ğŸ§¹ **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®å®‰å…¨æ€§**: ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ã‹ã‚‰å®‰å¿ƒã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’æ•´ç†ã§ãã‚‹

---

## 3. ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ–¹é‡

### Kent Beckã®ç†å¿µ
Kent Beckã®ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã€ã®åŸå‰‡ã«å¾“ã„ã¾ã™ã€‚

#### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®é»„é‡‘ãƒ«ãƒ¼ãƒ«
1. **å‹•ä½œã‚’å¤‰ãˆãšã«ã€æ§‹é€ ã ã‘ã‚’å¤‰ãˆã‚‹**
2. **å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—ã§é€²ã‚ã‚‹**
3. **å„ã‚¹ãƒ†ãƒƒãƒ—ã§ãƒ†ã‚¹ãƒˆã‚’é€šã™**

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°
- âŒ **ã—ãªã„æ–¹ãŒã„ã„ã¨ã**: å‹•ã‹ãªã„ã‚³ãƒ¼ãƒ‰ã‚’ç›´ã™ã¨ã
- âœ… **ã™ã¹ãã¨ã**: 
  - åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’3å›æ›¸ã„ãŸã¨ãï¼ˆ3åº¦ç›®ã®æ­£ç›´ï¼‰
  - æ–°æ©Ÿèƒ½è¿½åŠ å‰ã«ã€è¿½åŠ ã—ã‚„ã™ãã™ã‚‹ãŸã‚
  - ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§æŒ‡æ‘˜ã•ã‚ŒãŸã¨ã
  - ãƒ†ã‚¹ãƒˆãŒé€šã£ã¦ã„ã‚‹ã¨ã

### ã‚ˆãã‚ã‚‹ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³

#### ãƒ‘ã‚¿ãƒ¼ãƒ³1: é–¢æ•°ã®æŠ½å‡º
```typescript
// âŒ Before: é•·ã„é–¢æ•°
function drawDailyWord() {
  const today = new Date().toLocaleDateString('ja-JP');
  const lastDrawn = localStorage.getItem('lastDrawnDate');
  
  if (today === lastDrawn) {
    return JSON.parse(localStorage.getItem('todayWord') || '{}');
  }
  
  const allWords = JSON.parse(localStorage.getItem('vocabulary') || '[]');
  const randomIndex = Math.floor(Math.random() * allWords.length);
  const word = allWords[randomIndex];
  
  localStorage.setItem('lastDrawnDate', today);
  localStorage.setItem('todayWord', JSON.stringify(word));
  
  return word;
}

// âœ… After: é–¢æ•°ã‚’æŠ½å‡ºã—ã¦è²¬å‹™ã‚’åˆ†å‰²
function drawDailyWord(): VocabularyEntry {
  if (isAlreadyDrawnToday()) {
    return getTodayWord();
  }
  
  const word = selectRandomWord();
  saveTodayWord(word);
  
  return word;
}

function isAlreadyDrawnToday(): boolean {
  const today = new Date().toLocaleDateString('ja-JP');
  const lastDrawn = localStorage.getItem('lastDrawnDate');
  return today === lastDrawn;
}

function getTodayWord(): VocabularyEntry {
  return JSON.parse(localStorage.getItem('todayWord') || '{}');
}

function selectRandomWord(): VocabularyEntry {
  const allWords = JSON.parse(localStorage.getItem('vocabulary') || '[]');
  const randomIndex = Math.floor(Math.random() * allWords.length);
  return allWords[randomIndex];
}

function saveTodayWord(word: VocabularyEntry): void {
  const today = new Date().toLocaleDateString('ja-JP');
  localStorage.setItem('lastDrawnDate', today);
  localStorage.setItem('todayWord', JSON.stringify(word));
}
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã®å®šæ•°åŒ–
```typescript
// âŒ Before
if (favorites.length >= 100) {
  throw new Error('ãŠæ°—ã«å…¥ã‚Šã¯100ä»¶ã¾ã§ã§ã™');
}

// âœ… After
const MAX_FAVORITES = 100;

if (favorites.length >= MAX_FAVORITES) {
  throw new Error(`ãŠæ°—ã«å…¥ã‚Šã¯${MAX_FAVORITES}ä»¶ã¾ã§ã§ã™`);
}
```

---

## 4. ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°åŸå‰‡

### SOLIDåŸå‰‡

#### S: Single Responsibility Principleï¼ˆå˜ä¸€è²¬ä»»ã®åŸå‰‡ï¼‰
**1ã¤ã®ã‚¯ãƒ©ã‚¹/é–¢æ•°ã¯ã€1ã¤ã®ã“ã¨ã ã‘ã‚’ã™ã‚‹**

```typescript
// âŒ æ‚ªã„ä¾‹: è¤‡æ•°ã®è²¬ä»»ã‚’æŒã£ã¦ã„ã‚‹
class VocabularyManager {
  fetchFromAPI() { /* APIé€šä¿¡ */ }
  saveToStorage() { /* ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä¿å­˜ */ }
  displayOnUI() { /* UIè¡¨ç¤º */ }
}

// âœ… è‰¯ã„ä¾‹: è²¬ä»»ã‚’åˆ†å‰²
class VocabularyRepository {
  fetchFromAPI() { /* APIé€šä¿¡ã®ã¿ */ }
}

class VocabularyStorage {
  saveToStorage() { /* ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä¿å­˜ã®ã¿ */ }
}

class VocabularyUI {
  displayOnUI() { /* UIè¡¨ç¤ºã®ã¿ */ }
}
```

#### O: Open/Closed Principleï¼ˆé–‹æ”¾/é–‰é–ã®åŸå‰‡ï¼‰
**æ‹¡å¼µã«å¯¾ã—ã¦é–‹ã„ã¦ã„ã¦ã€ä¿®æ­£ã«å¯¾ã—ã¦é–‰ã˜ã¦ã„ã‚‹**

```typescript
// âœ… è‰¯ã„ä¾‹: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§æŠ½è±¡åŒ–
interface IStorage {
  save(key: string, value: unknown): Promise<void>;
  load(key: string): Promise<unknown>;
}

// æ–°ã—ã„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’è¿½åŠ ã™ã‚‹ã¨ãã¯ã€æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã›ãšæ–°ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
class IndexedDBStorage implements IStorage {
  async save(key: string, value: unknown): Promise<void> { /* ... */ }
  async load(key: string): Promise<unknown> { /* ... */ }
}

class LocalStorageAdapter implements IStorage {
  async save(key: string, value: unknown): Promise<void> { /* ... */ }
  async load(key: string): Promise<unknown> { /* ... */ }
}
```

#### L: Liskov Substitution Principleï¼ˆãƒªã‚¹ã‚³ãƒ•ã®ç½®æ›åŸå‰‡ï¼‰
**æ´¾ç”Ÿã‚¯ãƒ©ã‚¹ã¯åŸºåº•ã‚¯ãƒ©ã‚¹ã¨ç½®ãæ›ãˆå¯èƒ½ã§ã‚ã‚‹ã¹ã**

```typescript
// âœ… è‰¯ã„ä¾‹: ã©ã®Storageã‚‚åŒã˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ä½¿ãˆã‚‹
function saveData(storage: IStorage, data: unknown) {
  // IndexedDBã§ã‚‚LocalStorageã§ã‚‚åŒã˜ã‚ˆã†ã«ä½¿ãˆã‚‹
  await storage.save('key', data);
}
```

#### I: Interface Segregation Principleï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åˆ†é›¢ã®åŸå‰‡ï¼‰
**ä½¿ã‚ãªã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å«ã‚€å¤§ããªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚ˆã‚Šã€å°ã•ãªå°‚ç”¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’**

```typescript
// âŒ æ‚ªã„ä¾‹: å…¨éƒ¨å…¥ã‚Šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
interface IRepository {
  add(): void;
  update(): void;
  delete(): void;
  find(): void;
  findAll(): void;
}

// âœ… è‰¯ã„ä¾‹: å¿…è¦ãªæ©Ÿèƒ½ã ã‘ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
interface IReadableRepository {
  find(): void;
  findAll(): void;
}

interface IWritableRepository {
  add(): void;
  update(): void;
  delete(): void;
}
```

#### D: Dependency Inversion Principleï¼ˆä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ï¼‰
**å…·ä½“ã«ä¾å­˜ã›ãšã€æŠ½è±¡ã«ä¾å­˜ã™ã‚‹**

```typescript
// âŒ æ‚ªã„ä¾‹: å…·ä½“çš„ãªã‚¯ãƒ©ã‚¹ã«ä¾å­˜
class AddToFavorites {
  private storage = new LocalStorageAdapter(); // å…·ä½“ã«ä¾å­˜
}

// âœ… è‰¯ã„ä¾‹: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ä¾å­˜
class AddToFavorites {
  constructor(
    private storage: IStorage // æŠ½è±¡ã«ä¾å­˜
  ) {}
}
```

### KISSåŸå‰‡ï¼ˆKeep It Simple, Stupidï¼‰
**ã‚·ãƒ³ãƒ—ãƒ«ã«ä¿ã¤**

```typescript
// âŒ è¤‡é›‘ã™ã
const result = items.reduce((acc, item) => {
  return [...acc, ...item.values.filter(v => v.active).map(v => v.name)];
}, []);

// âœ… ã‚·ãƒ³ãƒ—ãƒ«ã§èª­ã¿ã‚„ã™ã„
const activeNames = items
  .flatMap(item => item.values)
  .filter(value => value.active)
  .map(value => value.name);
```

### YAGNIåŸå‰‡ï¼ˆYou Aren't Gonna Need Itï¼‰
**å¿…è¦ã«ãªã£ã¦ã‹ã‚‰ä½œã‚‹**

```typescript
// âŒ ä»Šã¯å¿…è¦ãªã„ã®ã«å…ˆå›ã‚Šã—ã¦å®Ÿè£…
interface VocabularyEntry {
  id: string;
  word: string;
  definition: string;
  // ä»¥ä¸‹ã€ä»Šã¯ä½¿ã‚ãªã„ãŒå°†æ¥ä½¿ã†ã‹ã‚‚ã—ã‚Œãªã„...ï¼Ÿ
  synonyms?: string[];
  antonyms?: string[];
  examples?: string[];
  etymology?: string;
  pronunciation?: string;
  partOfSpeech?: string[];
  frequency?: number;
  difficulty?: number;
}

// âœ… ä»Šå¿…è¦ãªæœ€å°é™ã ã‘
interface VocabularyEntry {
  id: string;
  word: string;
  definition: string;
  language: 'ja' | 'en';
}
```

### DRYåŸå‰‡ï¼ˆDon't Repeat Yourselfï¼‰
**åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’ç¹°ã‚Šè¿”ã•ãªã„**

```typescript
// âŒ ç¹°ã‚Šè¿”ã—
function getJapaneseWords() {
  const data = await fetch('/api/vocabulary-ja.json');
  const json = await data.json();
  return json;
}

function getEnglishWords() {
  const data = await fetch('/api/vocabulary-en.json');
  const json = await data.json();
  return json;
}

// âœ… å…±é€šåŒ–
async function getVocabulary(language: 'ja' | 'en'): Promise<VocabularyEntry[]> {
  const data = await fetch(`/api/vocabulary-${language}.json`);
  return await data.json();
}
```

---

## 5. ã‚³ãƒŸãƒƒãƒˆæ–¹é‡

### ã‚³ãƒŸãƒƒãƒˆã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°
- âœ… **é©åˆ‡ãªã¾ã¨ã¾ã‚ŠãŒã§ããŸã‚‰ã‚³ãƒŸãƒƒãƒˆ**
- âœ… **1ã¤ã®ã‚³ãƒŸãƒƒãƒˆã«ã¯1ã¤ã®å¤‰æ›´å†…å®¹**
- âœ… **ãƒ†ã‚¹ãƒˆãŒé€šã£ãŸçŠ¶æ…‹ã§ã‚³ãƒŸãƒƒãƒˆ**

### ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¦ç´„
Conventional Commitsã«å¾“ã†ã€‚

#### ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
```
<type>: <subject>

<body>ï¼ˆä»»æ„ï¼‰

<footer>ï¼ˆä»»æ„ï¼‰
```

#### Typeä¸€è¦§
- `feat`: æ–°æ©Ÿèƒ½
- `fix`: ãƒã‚°ä¿®æ­£
- `refactor`: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- `test`: ãƒ†ã‚¹ãƒˆè¿½åŠ ãƒ»ä¿®æ­£
- `docs`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `style`: ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆã‚³ãƒ¼ãƒ‰å‹•ä½œã«å½±éŸ¿ã—ãªã„ï¼‰
- `chore`: ãƒ“ãƒ«ãƒ‰ãƒ»è¨­å®šãªã©

#### ä¾‹
```bash
# è‰¯ã„ä¾‹
feat: ãŠæ°—ã«å…¥ã‚Šæ©Ÿèƒ½ã®è¿½åŠ 
fix: æ—¥æ›¿ã‚ã‚ŠæŠ½é¸ã®æ—¥ä»˜åˆ¤å®šãƒã‚°ã‚’ä¿®æ­£
refactor: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’ã‚¯ãƒ©ã‚¹åŒ–
test: DrawDailyWordã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè¿½åŠ 
docs: READMEã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã‚’è¿½åŠ 

# æ‚ªã„ä¾‹
fix: ãƒã‚°ä¿®æ­£  # ä½•ã®ãƒã‚°ï¼Ÿ
update: ã„ã‚ã„ã‚  # ä½•ã‚’ï¼Ÿ
WIP  # ä½œæ¥­ä¸­ã®ã‚³ãƒŸãƒƒãƒˆã¯é¿ã‘ã‚‹
```

### ã‚³ãƒŸãƒƒãƒˆå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
- [ ] ãƒ†ã‚¹ãƒˆãŒé€šã£ã¦ã„ã‚‹ã‹
- [ ] ãƒªãƒ³ã‚¿ãƒ¼ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹
- [ ] å‹ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹
- [ ] console.logã‚’å‰Šé™¤ã—ãŸã‹
- [ ] ä¸è¦ãªã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’å‰Šé™¤ã—ãŸã‹

---

## 6. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ç’°å¢ƒ

### ChromeDevTools MCPã¨ã®é€£æº

#### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

1. **MCPã‚µãƒ¼ãƒãƒ¼ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
```bash
# Claude MCPã«ChromeDevToolsã‚µãƒ¼ãƒãƒ¼ã‚’è¿½åŠ 
claude mcp add chrome-devtools
```

2. **é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•**
```bash
pnpm dev
```

3. **Chrome DevToolsã§è¨ˆæ¸¬**
- Lighthouseã‚¿ãƒ–ã‚’é–‹ã
- Performance Insightsã‚’æœ‰åŠ¹åŒ–
- Core Web Vitalsã‚’ç›£è¦–

#### è¨ˆæ¸¬æŒ‡æ¨™

##### Core Web Vitalsï¼ˆæœ€é‡è¦ï¼‰
- **LCP (Largest Contentful Paint)**: 2.5ç§’ä»¥å†…
  - ä¸»è¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è¡¨ç¤ºé€Ÿåº¦
- **FID (First Input Delay)**: 100msä»¥å†…
  - æœ€åˆã®å…¥åŠ›ã¸ã®å¿œç­”é€Ÿåº¦
- **CLS (Cumulative Layout Shift)**: 0.1ä»¥å†…
  - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ãšã‚Œã®å°‘ãªã•

##### è¿½åŠ æŒ‡æ¨™
- **FCP (First Contentful Paint)**: 1.8ç§’ä»¥å†…
- **TTI (Time to Interactive)**: 3.8ç§’ä»¥å†…
- **TBT (Total Blocking Time)**: 200msä»¥å†…

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ã®æµã‚Œ

```
1. ğŸ” è¨ˆæ¸¬
   â†“
2. ğŸ“Š ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®š
   â†“
3. ğŸ”§ æœ€é©åŒ–å®Ÿè£…
   â†“
4. ğŸ” å†è¨ˆæ¸¬ï¼ˆæ”¹å–„ç¢ºèªï¼‰
   â†“
5. ğŸ“ çµæœã‚’è¨˜éŒ²
```

#### æœ€é©åŒ–ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°
- âš ï¸ **é–‹ç™ºåˆæœŸ**: Coreæ©Ÿèƒ½å®Ÿè£…å¾Œã«1åº¦è¨ˆæ¸¬
- âš ï¸ **é–‹ç™ºä¸­æœŸ**: æ–°æ©Ÿèƒ½è¿½åŠ ã”ã¨ã«è¨ˆæ¸¬
- âš ï¸ **ãƒªãƒªãƒ¼ã‚¹å‰**: æœ€çµ‚ãƒã‚§ãƒƒã‚¯
- âŒ **ã‚„ã‚‰ãªã„**: é–‹ç™ºé–‹å§‹ç›´å¾Œï¼ˆæ©Ÿèƒ½ãŒãªã„ã®ã§æ„å‘³ãŒãªã„ï¼‰

---

## 7. è¿½åŠ ã®é–‹ç™ºãƒ«ãƒ¼ãƒ«

### ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹
1. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: XSSã€CSPã€æ©Ÿå¯†æƒ…å ±æ¼æ´©
2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã€ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯
3. **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£**: WCAG 2.2 AAæº–æ‹ 
4. **ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°åŸå‰‡**: SOLIDã€KISSã€YAGNIã€DRY
5. **å¯èª­æ€§**: å¤‰æ•°åã€é–¢æ•°åã€ã‚³ãƒ¡ãƒ³ãƒˆ

### ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥
```
main (æœ¬ç•ª)
  â†‘
develop (é–‹ç™º)
  â†‘
feature/xxx (æ©Ÿèƒ½é–‹ç™º)
```

#### ãƒ–ãƒ©ãƒ³ãƒå‘½åè¦å‰‡
```
feature/daily-draw-logic    # æ–°æ©Ÿèƒ½
fix/date-comparison-bug      # ãƒã‚°ä¿®æ­£
refactor/storage-adapter     # ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
test/add-favorites-test      # ãƒ†ã‚¹ãƒˆè¿½åŠ 
```

### ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- 1PRã¯300è¡Œä»¥å†…ã‚’ç›®å®‰
- å¤§ããªå¤‰æ›´ã¯è¤‡æ•°PRã«åˆ†å‰²
- ã‚»ãƒ«ãƒ•ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿…é ˆ
- ãƒ†ã‚¹ãƒˆçµæœã‚’æ·»ä»˜

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ–¹é‡
```typescript
// âœ… è‰¯ã„ä¾‹: é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
try {
  const data = await fetchVocabulary();
  return data;
} catch (error) {
  // ã‚¨ãƒ©ãƒ¼ã‚’ãƒ­ã‚°ã«è¨˜éŒ²
  console.error('èªå½™ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—:', error);
  
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  throw new Error('èªå½™ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
}

// âŒ æ‚ªã„ä¾‹
try {
  const data = await fetchVocabulary();
  return data;
} catch (error) {
  // ã‚¨ãƒ©ãƒ¼ã‚’æ¡ã‚Šã¤ã¶ã™ï¼ˆNGï¼‰
  return null;
}
```

### ãƒ­ã‚°æ–¹é‡
- **é–‹ç™ºç’°å¢ƒ**: console.log OK
- **æœ¬ç•ªç’°å¢ƒ**: console.logå‰Šé™¤ã€ã‚¨ãƒ©ãƒ¼ã®ã¿è¨˜éŒ²
- **æ©Ÿå¯†æƒ…å ±**: çµ¶å¯¾ã«ãƒ­ã‚°ã«å‡ºã•ãªã„

---

## 8. åˆå¿ƒè€…å‘ã‘è§£èª¬

### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã£ã¦ä½•ï¼Ÿ

#### ç°¡å˜ã«è¨€ã†ã¨
**ã€Œã‚³ãƒ¼ãƒ‰ã‚’å½¹å‰²ã”ã¨ã«åˆ†ã‘ã¦ã€å¤‰æ›´ã«å¼·ãã™ã‚‹è¨­è¨ˆã€**

#### ãªãœå¿…è¦ï¼Ÿ
é€šå¸¸ã®ã‚³ãƒ¼ãƒ‰ã ã¨...
```typescript
// âŒ å…¨éƒ¨æ··ã–ã£ã¦ã‚‹ï¼ˆã‚¹ãƒ‘ã‚²ãƒƒãƒ†ã‚£ã‚³ãƒ¼ãƒ‰ï¼‰
function addFavorite(word: string) {
  // ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ï¼‰
  if (favorites.length >= 100) return;
  
  // ãƒ‡ãƒ¼ã‚¿ä¿å­˜ï¼ˆã‚¤ãƒ³ãƒ•ãƒ©ï¼‰
  localStorage.setItem('favorites', JSON.stringify([...favorites, word]));
  
  // UIæ›´æ–°ï¼ˆãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
  document.getElementById('list').innerHTML += `<li>${word}</li>`;
}
```

å•é¡Œç‚¹ï¼š
- localStorageã‚’IndexedDBã«å¤‰ãˆãŸã„ â†’ å…¨éƒ¨æ›¸ãç›´ã— ğŸ˜±
- UIã‚’Reactã‹ã‚‰Vueã«å¤‰ãˆãŸã„ â†’ å…¨éƒ¨æ›¸ãç›´ã— ğŸ˜±
- ãƒ†ã‚¹ãƒˆã‚’æ›¸ããŸã„ â†’ localStorageã®ãƒ¢ãƒƒã‚¯ãŒå¿…è¦ã§é¢å€’ ğŸ˜±

ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã ã¨...
```typescript
// âœ… å½¹å‰²ã”ã¨ã«åˆ†é›¢

// 1. ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
class AddToFavoritesUseCase {
  constructor(private repository: IFavoritesRepository) {}
  
  async execute(word: VocabularyEntry) {
    if (await this.repository.count() >= 100) {
      throw new Error('ä¸Šé™ã§ã™');
    }
    await this.repository.add(word);
  }
}

// 2. ã‚¤ãƒ³ãƒ•ãƒ©å±¤ï¼ˆãƒ‡ãƒ¼ã‚¿ä¿å­˜ï¼‰
class LocalStorageRepository implements IFavoritesRepository {
  async add(word: VocabularyEntry) {
    // localStorageä¿å­˜
  }
}

// 3. ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆUIï¼‰
function FavoriteButton({ word }: Props) {
  const addToFavorites = useAddToFavorites();
  
  return (
    <button onClick={() => addToFavorites.execute(word)}>
      â­ãŠæ°—ã«å…¥ã‚Š
    </button>
  );
}
```

ãƒ¡ãƒªãƒƒãƒˆï¼š
- âœ… IndexedDBã«å¤‰ãˆãŸã„ â†’ Repositoryã ã‘å¤‰æ›´
- âœ… Vueã«å¤‰ãˆãŸã„ â†’ ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã ã‘å¤‰æ›´
- âœ… ãƒ†ã‚¹ãƒˆ â†’ ãƒ¢ãƒƒã‚¯Repositoryã§ç°¡å˜

### ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒã£ã¦ä½•ï¼Ÿ

#### ç°¡å˜ã«è¨€ã†ã¨
**ã€Œãƒ‡ãƒ¼ã‚¿ã®è¨­è¨ˆå›³ã€**

#### ãªãœå¿…è¦ï¼Ÿ
- å¾Œã§ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å¤‰ãˆã‚‹ã®ã¯å¤§å¤‰
- ãƒãƒ¼ãƒ å…¨å“¡ãŒåŒã˜æ§‹é€ ã‚’ç†è§£ã§ãã‚‹
- TypeScriptã®å‹å®šç¾©ã¨ä¸€è‡´ã•ã›ã‚‹

#### ä¾‹ï¼šçŸ¥è­˜ãƒªã‚¹ãƒˆã®ã‚¹ã‚­ãƒ¼ãƒ
```typescript
/**
 * è‡ªåˆ†ã®çŸ¥è­˜ãƒªã‚¹ãƒˆã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ - IndexedDBï¼‰
 * 
 * ãªãœã“ã®æ§‹é€ ï¼Ÿ
 * - wordId: å…ƒã®èªå½™ãƒ‡ãƒ¼ã‚¿ã¸ã®å‚ç…§ï¼ˆæ­£è¦åŒ–ï¼‰
 * - word, reading, definition: è¡¨ç¤ºç”¨ã«ã‚³ãƒ”ãƒ¼ï¼ˆéæ­£è¦åŒ–ã€å–å¾—ã‚’é«˜é€ŸåŒ–ï¼‰
 * - knows: ã€ŒçŸ¥ã£ã¦ã‚‹ã€ã‹ã€ŒçŸ¥ã‚‰ãªã„ã€ã‹ã®ãƒ•ãƒ©ã‚°
 * - votedAt: æŠ•ç¥¨æ—¥æ™‚ã‚’è¨˜éŒ²ï¼ˆã‚½ãƒ¼ãƒˆã«ä½¿ãˆã‚‹ï¼‰
 */
interface MyKnowledge {
  wordId: string;      // èªå½™IDï¼ˆä¾‹: "word-12345"ï¼‰
  word: string;        // è¦‹å‡ºã—èª
  reading?: string;    // èª­ã¿ä»®åï¼ˆæ—¥æœ¬èªã®ã¿ï¼‰
  definition: string;  // å®šç¾©
  knows: boolean;      // true: çŸ¥ã£ã¦ã‚‹, false: çŸ¥ã‚‰ãªã„
  votedAt: number;     // æŠ•ç¥¨æ—¥æ™‚ï¼ˆUnixã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼‰
}

/**
 * æŠ•ç¥¨çµ±è¨ˆã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ - PostgreSQLï¼‰
 * 
 * ãªãœã“ã®æ§‹é€ ï¼Ÿ
 * - word_id: èªå½™ãƒ‡ãƒ¼ã‚¿ã¸ã®å¤–éƒ¨ã‚­ãƒ¼å‚ç…§
 * - know_count, unknown_count: é›†è¨ˆã‚«ã‚¦ãƒ³ãƒˆï¼ˆæ›´æ–°ã®ãŸã³ã«+1ï¼‰
 * - updated_at: æœ€çµ‚æ›´æ–°æ—¥æ™‚ï¼ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°è¨ˆç®—ã®éš›ã«ä½¿ç”¨ï¼‰
 */
interface WordStats {
  wordId: string;        // èªå½™ID
  knowCount: number;     // ã€ŒçŸ¥ã£ã¦ã‚‹ã€ã®ç·æ•°
  unknownCount: number;  // ã€ŒçŸ¥ã‚‰ãªã„ã€ã®ç·æ•°
  updatedAt: Date;       // æœ€çµ‚æ›´æ–°æ—¥æ™‚
}
```

#### æ­£è¦åŒ– vs éæ­£è¦åŒ–

**æ­£è¦åŒ–**ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚’åˆ†å‰²ã—ã¦é‡è¤‡ã‚’æ¸›ã‚‰ã™ï¼‰
```typescript
// vocabularyãƒ†ãƒ¼ãƒ–ãƒ«
{ id: "1", word: "çŠ¬", definition: "..." }

// favoritesãƒ†ãƒ¼ãƒ–ãƒ«
{ entryId: "1", addedAt: 1234567890 }
```
ãƒ¡ãƒªãƒƒãƒˆ: ãƒ‡ãƒ¼ã‚¿ã®ä¸€è²«æ€§ã€æ›´æ–°ãŒæ¥½
ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ: å–å¾—æ™‚ã«JOINãŒå¿…è¦ï¼ˆé…ã„ï¼‰

**éæ­£è¦åŒ–**ï¼ˆãƒ‡ãƒ¼ã‚¿ã‚’é‡è¤‡ã•ã›ã¦é«˜é€ŸåŒ–ï¼‰
```typescript
// favoritesãƒ†ãƒ¼ãƒ–ãƒ«
{
  entryId: "1",
  addedAt: 1234567890,
  entry: { id: "1", word: "çŠ¬", definition: "..." } // é‡è¤‡
}
```
ãƒ¡ãƒªãƒƒãƒˆ: å–å¾—ãŒé€Ÿã„ï¼ˆJOINãªã—ï¼‰
ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ: ãƒ‡ãƒ¼ã‚¿ãŒé‡è¤‡ã€æ›´æ–°æ™‚ã«è¤‡æ•°ç®‡æ‰€ã‚’å¤‰æ›´

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€**ãŠæ°—ã«å…¥ã‚Šã¯èª­ã¿å–ã‚Šãƒ¡ã‚¤ãƒ³**ãªã®ã§éæ­£è¦åŒ–ã‚’æ¡ç”¨ã€‚

### ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ã£ã¦ä½•ï¼Ÿ

#### ç°¡å˜ã«è¨€ã†ã¨
**ã€Œãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ãƒ»å–å¾—ã‚’ã™ã‚‹äººï¼ˆã‚¯ãƒ©ã‚¹ï¼‰ã€**

#### ãªãœå¿…è¦ï¼Ÿ
ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã‚’åˆ†é›¢ã™ã‚‹ãŸã‚ã€‚

```typescript
// âŒ æ‚ªã„ä¾‹: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«localStorageã¨APIé€šä¿¡ãŒæ··ã–ã£ã¦ã‚‹
function submitVote(wordId: string, word: string, knows: boolean) {
  const knowledge = JSON.parse(localStorage.getItem('myKnowledge') || '[]');
  knowledge.push({ wordId, word, knows, votedAt: Date.now() });
  localStorage.setItem('myKnowledge', JSON.stringify(knowledge));
  
  fetch('/api/vote', {
    method: 'POST',
    body: JSON.stringify({ wordId, knows })
  });
}

// âœ… è‰¯ã„ä¾‹: ãƒªãƒã‚¸ãƒˆãƒªã¨APIé€šä¿¡ã‚’åˆ†é›¢
interface IKnowledgeRepository {
  find(wordId: string): Promise<MyKnowledge | null>;
  add(knowledge: MyKnowledge): Promise<void>;
  getAll(): Promise<MyKnowledge[]>;
}

interface IVoteApiClient {
  submitVote(wordId: string, knows: boolean): Promise<void>;
}

class KnowledgeRepository implements IKnowledgeRepository {
  // ã“ã“ã§IndexedDBã‚’ä½¿ã†
  async add(knowledge: MyKnowledge): Promise<void> {
    // å®Ÿè£…...
  }
}

class VoteApiClient implements IVoteApiClient {
  // ã“ã“ã§fetch APIã‚’ä½¿ã†
  async submitVote(wordId: string, knows: boolean): Promise<void> {
    // å®Ÿè£…...
  }
}

// ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯ãƒªãƒã‚¸ãƒˆãƒªã¨APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ä½¿ã†ã ã‘
class SubmitKnowledgeUseCase {
  constructor(
    private knowledgeRepository: IKnowledgeRepository,
    private voteApiClient: IVoteApiClient
  ) {}
  
  async execute(entry: VocabularyEntry, knows: boolean) {
    // é‡è¤‡ãƒã‚§ãƒƒã‚¯
    const existing = await this.knowledgeRepository.find(entry.id);
    if (existing) throw new Error('ã™ã§ã«æŠ•ç¥¨æ¸ˆã¿ã§ã™');
    
    // ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜
    await this.knowledgeRepository.add({
      wordId: entry.id,
      word: entry.word,
      reading: entry.reading,
      definition: entry.definition,
      knows,
      votedAt: Date.now()
    });
    
    // ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«é€ä¿¡
    await this.voteApiClient.submitVote(entry.id, knows);
  }
}
```

ãƒ¡ãƒªãƒƒãƒˆï¼š
- âœ… ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚·ãƒ³ãƒ—ãƒ«
- âœ… ãƒ‡ãƒ¼ã‚¿ä¿å­˜æ–¹æ³•ã‚’ç°¡å˜ã«å¤‰æ›´ã§ãã‚‹
- âœ… ãƒ†ã‚¹ãƒˆãŒæ›¸ãã‚„ã™ã„ï¼ˆãƒ¢ãƒƒã‚¯Repositoryã‚’æ³¨å…¥ï¼‰

### ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã£ã¦ä½•ï¼Ÿ

#### ç°¡å˜ã«è¨€ã†ã¨
**ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚„ã‚ŠãŸã„ã“ã¨ã€ã‚’è¡¨ã™ã‚¯ãƒ©ã‚¹/é–¢æ•°**

#### ä¾‹
- `DrawDailyWord`ï¼ˆä»Šæ—¥ã®ä¸€èªã‚’å¼•ãï¼‰
- `SubmitKnowledge`ï¼ˆã€ŒçŸ¥ã£ã¦ã‚‹ / çŸ¥ã‚‰ãªã„ã€æŠ•ç¥¨ï¼‰
- `GetMyKnowledgeList`ï¼ˆè‡ªåˆ†ã®çŸ¥è­˜ãƒªã‚¹ãƒˆã‚’å–å¾—ï¼‰
- `GetWordStats`ï¼ˆèªã®çµ±è¨ˆæƒ…å ±ã‚’å–å¾—ï¼‰
- `GetRanking`ï¼ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å–å¾—ï¼‰

#### ãªãœã‚¯ãƒ©ã‚¹ã«åˆ†ã‘ã‚‹ã®ï¼Ÿ
```typescript
// âŒ æ‚ªã„ä¾‹: 1ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å…¨éƒ¨
function doEverything() {
  // 100è¡Œä»¥ä¸Šã®ã‚³ãƒ¼ãƒ‰...
}

// âœ… è‰¯ã„ä¾‹: ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã”ã¨ã«åˆ†é›¢
class DrawDailyWord {
  async execute(): Promise<VocabularyEntry> {
    // ä»Šæ—¥ã®ä¸€èªã‚’å¼•ããƒ­ã‚¸ãƒƒã‚¯ã®ã¿ï¼ˆ10ã€œ20è¡Œï¼‰
  }
}

class SubmitKnowledge {
  async execute(entry: VocabularyEntry, knows: boolean): Promise<void> {
    // æŠ•ç¥¨å‡¦ç†ã®ãƒ­ã‚¸ãƒƒã‚¯ã®ã¿ï¼ˆ10ã€œ20è¡Œï¼‰
  }
}

class GetWordStats {
  async execute(wordId: string): Promise<WordStats> {
    // çµ±è¨ˆæƒ…å ±å–å¾—ã®ãƒ­ã‚¸ãƒƒã‚¯ã®ã¿ï¼ˆ10ã€œ20è¡Œï¼‰
  }
}
```

ãƒ¡ãƒªãƒƒãƒˆï¼š
- âœ… 1ã¤ã®ã‚¯ãƒ©ã‚¹ãŒå°ã•ãã¦èª­ã¿ã‚„ã™ã„
- âœ… ãƒ†ã‚¹ãƒˆãŒæ›¸ãã‚„ã™ã„ï¼ˆ1ã¤ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã ã‘ãƒ†ã‚¹ãƒˆï¼‰
- âœ… å¤‰æ›´ã®å½±éŸ¿ç¯„å›²ãŒé™å®šçš„

### ä¾å­˜æ€§æ³¨å…¥ï¼ˆDIï¼‰ã£ã¦ä½•ï¼Ÿ

#### ç°¡å˜ã«è¨€ã†ã¨
**ã€Œå¿…è¦ãªã‚‚ã®ã‚’å¤–ã‹ã‚‰æ¸¡ã™ã€**

```typescript
// âŒ æ‚ªã„ä¾‹: ã‚¯ãƒ©ã‚¹å†…ã§ç›´æ¥newã™ã‚‹ï¼ˆä¾å­˜ãŒå›ºå®šã•ã‚Œã‚‹ï¼‰
class SubmitKnowledge {
  private repository = new IndexedDBRepository(); // ã“ã‚Œã ã¨IndexedDBã«å›ºå®š
  private apiClient = new VoteApiClient(); // APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚‚å›ºå®š
  
  async execute(entry: VocabularyEntry, knows: boolean) {
    await this.repository.add({ 
      wordId: entry.id, 
      word: entry.word,
      reading: entry.reading,
      definition: entry.definition,
      knows, 
      votedAt: Date.now() 
    });
    await this.apiClient.submitVote(entry.id, knows);
  }
}

// âœ… è‰¯ã„ä¾‹: å¤–ã‹ã‚‰æ¸¡ã™ï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰
class SubmitKnowledge {
  constructor(
    private repository: IKnowledgeRepository, // ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãªã®ã§ä½•ã§ã‚‚æ¸¡ã›ã‚‹
    private apiClient: IVoteApiClient // ãƒ†ã‚¹ãƒˆæ™‚ã¯ãƒ¢ãƒƒã‚¯ã‚’æ³¨å…¥ã§ãã‚‹
  ) {}
  
  async execute(entry: VocabularyEntry, knows: boolean) {
    await this.repository.add({ 
      wordId: entry.id, 
      word: entry.word,
      reading: entry.reading,
      definition: entry.definition,
      knows, 
      votedAt: Date.now() 
    });
    await this.apiClient.submitVote(entry.id, knows);
  }
}

// ä½¿ã†ã¨ãã«æ¸¡ã™
const repository = new IndexedDBRepository(); // ã¾ãŸã¯ LocalStorageRepository
const apiClient = new VoteApiClient(); // ã¾ãŸã¯ MockVoteApiClientï¼ˆãƒ†ã‚¹ãƒˆæ™‚ï¼‰
const usecase = new SubmitKnowledge(repository, apiClient);
```

ãƒ¡ãƒªãƒƒãƒˆï¼š
- âœ… ãƒ†ã‚¹ãƒˆæ™‚ã«ãƒ¢ãƒƒã‚¯ã‚’æ³¨å…¥ã§ãã‚‹
- âœ… å®Ÿè£…ã‚’ç°¡å˜ã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹
- âœ… ç–çµåˆï¼ˆå¤‰æ›´ã«å¼·ã„ï¼‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã£ã¦ä½•ï¼Ÿï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘ï¼‰

#### ç°¡å˜ã«è¨€ã†ã¨
**ã€Œã‚µãƒ¼ãƒãƒ¼å´ã§å‹•ããƒ—ãƒ­ã‚°ãƒ©ãƒ ã€**

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€åŒ¿åã®æŠ•ç¥¨ã‚’é›†è¨ˆã™ã‚‹ãŸã‚ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒå¿…è¦ã ã‚ˆï¼

#### ãªãœãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒå¿…è¦ï¼Ÿ

```
âŒ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã ã‘ã®å ´åˆ:
ãƒ¦ãƒ¼ã‚¶ãƒ¼A â†’ IndexedDBï¼ˆAã ã‘ã®ãƒ‡ãƒ¼ã‚¿ï¼‰
ãƒ¦ãƒ¼ã‚¶ãƒ¼B â†’ IndexedDBï¼ˆBã ã‘ã®ãƒ‡ãƒ¼ã‚¿ï¼‰
â†’ é›†è¨ˆã§ããªã„ï¼ä»–äººã®æŠ•ç¥¨ãŒè¦‹ãˆãªã„ï¼

âœ… ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚ã‚Šã®å ´åˆ:
ãƒ¦ãƒ¼ã‚¶ãƒ¼A â†’ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ â†’ API â†’ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ â†’ PostgreSQL
ãƒ¦ãƒ¼ã‚¶ãƒ¼B â†’ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ â†’ API â†’ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ â†’ PostgreSQL
                                     â†“
                              é›†è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
                                     â†“
                              ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¨ˆç®—
```

#### Honoï¼ˆãƒ›ãƒï¼‰ã£ã¦ä½•ï¼Ÿ

**ã€Œè»½é‡ã§é«˜é€ŸãªWebãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€**

Express.jsã®ã‚ˆã†ãªã‚‚ã®ã ã‘ã©ã€ã‚‚ã£ã¨è»½ãã¦é€Ÿã„ï¼

```typescript
// Honoã®åŸºæœ¬ä¾‹
import { Hono } from 'hono';

const app = new Hono();

// GET /hello ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚‰ "Hello World!" ã‚’è¿”ã™
app.get('/hello', (c) => {
  return c.json({ message: 'Hello World!' });
});

// POST /api/vote ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚‰æŠ•ç¥¨ã‚’å—ã‘å–ã‚‹
app.post('/api/vote', async (c) => {
  const { wordId, knows } = await c.req.json();
  
  // ã“ã“ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã™ã‚‹å‡¦ç†
  
  return c.json({ success: true });
});

export default app;
```

#### Prismaï¼ˆãƒ—ãƒªã‚ºãƒï¼‰ã£ã¦ä½•ï¼Ÿ

**ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç°¡å˜ã«æ‰±ãˆã‚‹ãƒ„ãƒ¼ãƒ«ï¼ˆORMï¼‰ã€**

SQLã‚’æ›¸ã‹ãªãã¦ã‚‚ã€TypeScriptã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œãŒã§ãã‚‹ï¼

```typescript
// Prismaã®åŸºæœ¬ä¾‹

// âŒ ç”Ÿã®SQLï¼ˆåˆå¿ƒè€…ã«ã¯é›£ã—ã„ï¼‰
const result = await db.query(`
  UPDATE word_stats 
  SET know_count = know_count + 1, updated_at = NOW() 
  WHERE word_id = $1
`, [wordId]);

// âœ… Prismaï¼ˆã‚ã‹ã‚Šã‚„ã™ã„ï¼ï¼‰
const result = await prisma.wordStats.update({
  where: { wordId: wordId },
  data: { 
    knowCount: { increment: 1 },
    updatedAt: new Date()
  }
});
```

#### REST APIã£ã¦ä½•ï¼Ÿ

**ã€Œãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒé€šä¿¡ã™ã‚‹ãŸã‚ã®ãƒ«ãƒ¼ãƒ«ã€**

```typescript
// ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰æŠ•ç¥¨ã‚’é€ä¿¡
const response = await fetch('https://your-api.com/api/vote', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ 
    wordId: 'word-123', 
    knows: true 
  })
});

// ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§å—ã‘å–ã‚‹
app.post('/api/vote', async (c) => {
  const { wordId, knows } = await c.req.json();
  
  // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
  await prisma.wordStats.update({
    where: { wordId },
    data: { 
      knowCount: knows ? { increment: 1 } : undefined,
      unknownCount: !knows ? { increment: 1 } : undefined
    }
  });
  
  return c.json({ success: true });
});
```

#### PostgreSQLã£ã¦ä½•ï¼Ÿ

**ã€Œãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€**

è¤‡æ•°äººã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ãƒ»é›†è¨ˆã™ã‚‹ãŸã‚ã«ä½¿ã†ã€‚

```sql
-- ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ§‹é€ ï¼ˆPrismaã§è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ï¼‰
CREATE TABLE word_stats (
  word_id VARCHAR PRIMARY KEY,
  know_count INTEGER DEFAULT 0,
  unknown_count INTEGER DEFAULT 0,
  updated_at TIMESTAMP DEFAULT NOW()
);

-- æŠ•ç¥¨ã®ãŸã³ã«+1ã•ã‚Œã‚‹
UPDATE word_stats 
SET know_count = know_count + 1 
WHERE word_id = 'word-123';
```

#### Supabaseã£ã¦ä½•ï¼Ÿ

**ã€ŒPostgreSQLã‚’ã‚¯ãƒ©ã‚¦ãƒ‰ã§ä½¿ãˆã‚‹ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆç„¡æ–™æ ã‚ã‚Šï¼‰ã€**

- è‡ªåˆ†ã§ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¦ãªãã¦ã„ã„
- ç„¡æ–™ã§500MBã¾ã§ä½¿ãˆã‚‹
- Webã®UIã§ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã§ãã‚‹

#### Cloudflare Workersã£ã¦ä½•ï¼Ÿ

**ã€Œãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆHonoï¼‰ã‚’å‹•ã‹ã™å ´æ‰€ï¼ˆç„¡æ–™æ ã‚ã‚Šï¼‰ã€**

- ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ï¼ˆã‚µãƒ¼ãƒãƒ¼ç®¡ç†ä¸è¦ï¼‰
- ç„¡æ–™ã§1æ—¥10ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§
- ä¸–ç•Œä¸­ã«åˆ†æ•£ã•ã‚Œã¦é€Ÿã„

### ã‚ã‹ã‚‰ãªã„è¨€è‘‰ãŒå‡ºã¦ããŸã‚‰

1. **ã‚³ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚€** â†’ å®Ÿè£…å†…ã«èª¬æ˜ãŒã‚ã‚Šã¾ã™
2. **MDNã‚’èª¿ã¹ã‚‹** â†’ JavaScript/Web API ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
3. **Honoå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** â†’ https://hono.dev/
4. **Prismaå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** â†’ https://www.prisma.io/docs
5. **è³ªå•ã™ã‚‹** â†’ ã‚ã‹ã‚‰ãªã„ã¾ã¾é€²ã‚ãªã„ï¼

---

## 9. E2Eãƒ†ã‚¹ãƒˆã¨ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£è‡ªå‹•æ¤œè¨¼

### Playwrightã®å°å…¥

#### ãªãœPlaywrightãŒå¿…è¦ï¼Ÿ

**E2Eãƒ†ã‚¹ãƒˆã¨ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æ¤œè¨¼ã®é‡è¦æ€§**ï¼š
- âœ… ãƒ†ã‚¹ãƒˆã®å®Ÿè£…ï¼ˆVitest + React Testing Libraryï¼‰â†’ **å“è³ªä¿è¨¼ã®åŸºæœ¬**
- âœ… ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ â†’ **ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®é…æ…®**
- âœ… å“è³ªé‡è¦–ã®é–‹ç™ºå§¿å‹¢ â†’ **ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ãªé–‹ç™ºç¿’æ…£**

**å®Ÿå‹™ãƒ¬ãƒ™ãƒ«ã®é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹**ï¼š
```
åŸºæœ¬ãƒ¬ãƒ™ãƒ«: å˜ä½“ãƒ†ã‚¹ãƒˆã®ã¿
      â†“
å®Ÿå‹™ãƒ¬ãƒ™ãƒ«: å˜ä½“ãƒ†ã‚¹ãƒˆ + E2Eãƒ†ã‚¹ãƒˆ + ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£è‡ªå‹•æ¤œè¨¼
      â†“
åŠ¹æœ: ã€Œå“è³ªã¸ã®æ„è­˜ãŒé«˜ã„ã€ã€Œå®Ÿå‹™ãƒ¬ãƒ™ãƒ«ã®ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã‚’ç†è§£ã€
```

#### ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®å…¨ä½“åƒ

```
å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆVitestï¼‰: 70%
  - ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯
  - ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
  - ãƒªãƒã‚¸ãƒˆãƒª

E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰: 20%
  - é‡è¦ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼
  - ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ‘ã‚¹
  - ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶å‹•ä½œç¢ºèª

ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆï¼ˆaxe-coreï¼‰: 10%
  - WCAG 2.2 AAæº–æ‹ ãƒã‚§ãƒƒã‚¯
  - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ
  - ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼å¯¾å¿œ

æ‰‹å‹•ãƒ†ã‚¹ãƒˆ: å¿…è¦ã«å¿œã˜ã¦
```

#### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# Playwrightã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm add -D @playwright/test @axe-core/playwright

# ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pnpm playwright install
```

#### åŸºæœ¬çš„ãªE2Eãƒ†ã‚¹ãƒˆä¾‹

```typescript
// tests/e2e/daily-draw.spec.ts
import { test, expect } from '@playwright/test';

test.describe('æ—¥æ›¿ã‚ã‚ŠæŠ•ç¥¨æ©Ÿèƒ½', () => {
  test('ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ1æ—¥1å›ã ã‘å¼•ã‘ã‚‹ã“ã¨ã‚’ç¢ºèª', async ({ page }) => {
    await page.goto('http://localhost:5173');
    
    // 1å›ç›®: æ­£å¸¸ã«å¼•ã‘ã‚‹
    await page.click('button:has-text("ä»Šæ—¥ã®ä¸€èªã‚’å¼•ã")');
    await expect(page.locator('.entry-card')).toBeVisible();
    
    // 2å›ç›®: ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹
    const button = page.locator('button:has-text("ä»Šæ—¥ã®ä¸€èªã‚’å¼•ã")');
    await expect(button).toBeDisabled();
    
    // ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚åŒã˜èªãŒè¡¨ç¤ºã•ã‚Œã‚‹
    const firstWord = await page.locator('.entry-card .word').textContent();
    await page.reload();
    const secondWord = await page.locator('.entry-card .word').textContent();
    expect(firstWord).toBe(secondWord);
  });
  
  test('ã€ŒçŸ¥ã£ã¦ã‚‹ã€ã«æŠ•ç¥¨ã§ãã‚‹', async ({ page }) => {
    await page.goto('http://localhost:5173');
    
    // ä¸€èªã‚’å¼•ã
    await page.click('button:has-text("ä»Šæ—¥ã®ä¸€èªã‚’å¼•ã")');
    const word = await page.locator('.entry-card .word').textContent();
    
    // ã€ŒçŸ¥ã£ã¦ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.click('button:has-text("çŸ¥ã£ã¦ã‚‹")');
    
    // çµ±è¨ˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.locator('.stats-display')).toBeVisible();
    await expect(page.locator('.stats-display')).toContainText('%');
    
    // ã€ŒçŸ¥ã£ã¦ã‚‹ãƒªã‚¹ãƒˆã€ãƒšãƒ¼ã‚¸ã§ç¢ºèª
    await page.click('a:has-text("çŸ¥ã£ã¦ã‚‹")');
    await expect(page.locator('.knowledge-list')).toContainText(word);
  });
  
  test('ã€ŒçŸ¥ã‚‰ãªã„ã€ã«æŠ•ç¥¨ã§ãã‚‹', async ({ page }) => {
    await page.goto('http://localhost:5173');
    
    // ä¸€èªã‚’å¼•ã
    await page.click('button:has-text("ä»Šæ—¥ã®ä¸€èªã‚’å¼•ã")');
    const word = await page.locator('.entry-card .word').textContent();
    
    // ã€ŒçŸ¥ã‚‰ãªã„ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
    await page.click('button:has-text("çŸ¥ã‚‰ãªã„")');
    
    // çµ±è¨ˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.locator('.stats-display')).toBeVisible();
    
    // ã€ŒçŸ¥ã‚‰ãªã„ãƒªã‚¹ãƒˆã€ãƒšãƒ¼ã‚¸ã§ç¢ºèª
    await page.click('a:has-text("çŸ¥ã‚‰ãªã„")');
    await expect(page.locator('.knowledge-list')).toContainText(word);
  });
  
  test('æŠ•ç¥¨å¾Œã«åŒã˜èªã¯äºŒåº¦ã¨è¡¨ç¤ºã•ã‚Œãªã„', async ({ page }) => {
    await page.goto('http://localhost:5173');
    
    // 1èªç›®ã‚’å¼•ã„ã¦æŠ•ç¥¨
    await page.click('button:has-text("ä»Šæ—¥ã®ä¸€èªã‚’å¼•ã")');
    const firstWord = await page.locator('.entry-card .word').textContent();
    await page.click('button:has-text("çŸ¥ã£ã¦ã‚‹")');
    
    // æ¬¡ã®æ—¥ã«é€²ã‚ã‚‹ï¼ˆãƒ†ã‚¹ãƒˆç’°å¢ƒã®æ—¥ä»˜ã‚’å¤‰æ›´ï¼‰
    await page.evaluate(() => {
      const tomorrow = new Date();
      tomorrow.setDate(tomorrow.getDate() + 1);
      // ãƒ¢ãƒƒã‚¯ã§æ—¥ä»˜ã‚’å¤‰æ›´
    });
    
    await page.reload();
    
    // 2èªç›®ã‚’å¼•ãï¼ˆ1èªç›®ã¨ã¯é•ã†èªãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼‰
    await page.click('button:has-text("ä»Šæ—¥ã®ä¸€èªã‚’å¼•ã")');
    const secondWord = await page.locator('.entry-card .word').textContent();
    
    expect(firstWord).not.toBe(secondWord);
  });
  
  test('ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async ({ page }) => {
    await page.goto('http://localhost:5173/ranking');
    
    // ã€ŒçŸ¥ã‚‰ãªã„äººãŒå¤šã„ã€ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.locator('.ranking-unknown')).toBeVisible();
    await expect(page.locator('.ranking-unknown .ranking-item')).toHaveCount.greaterThan(0);
    
    // å„é …ç›®ã«èªã¨çµ±è¨ˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
    const firstItem = page.locator('.ranking-item').first();
    await expect(firstItem.locator('.word')).toBeVisible();
    await expect(firstItem.locator('.unknown-rate')).toContainText('%');
  });
});
```

#### ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£è‡ªå‹•ãƒ†ã‚¹ãƒˆ

```typescript
// tests/accessibility/wcag.spec.ts
import { test, expect } from '@playwright/test';
import AxeBuilder from '@axe-core/playwright';

test.describe('WCAG 2.2 AAæº–æ‹ ãƒã‚§ãƒƒã‚¯', () => {
  test('ãƒ›ãƒ¼ãƒ ç”»é¢', async ({ page }) => {
    await page.goto('http://localhost:5173');
    
    const results = await new AxeBuilder({ page })
      .withTags(['wcag2aa', 'wcag21aa', 'wcag22aa'])
      .analyze();
    
    expect(results.violations).toEqual([]);
  });
  
  test('ãŠæ°—ã«å…¥ã‚Šç”»é¢', async ({ page }) => {
    await page.goto('http://localhost:5173/favorites');
    
    const results = await new AxeBuilder({ page })
      .withTags(['wcag2aa', 'wcag21aa', 'wcag22aa'])
      .analyze();
    
    expect(results.violations).toEqual([]);
  });
  
  test('ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºæ™‚', async ({ page }) => {
    await page.goto('http://localhost:5173');
    
    // ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã‚’ä½œã‚‹ï¼ˆä¾‹: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ï¼‰
    await page.route('**/vocabulary-*.json', route => route.abort());
    await page.reload();
    
    const results = await new AxeBuilder({ page })
      .withTags(['wcag2aa'])
      .analyze();
    
    expect(results.violations).toEqual([]);
  });
});

test.describe('ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ', () => {
  test('Tabã‚­ãƒ¼ã§å…¨è¦ç´ ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã§ãã‚‹', async ({ page }) => {
    await page.goto('http://localhost:5173');
    
    // Tabã‚­ãƒ¼ã§é †ç•ªã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
    await page.keyboard.press('Tab');
    let focused = await page.locator(':focus');
    await expect(focused).toBeVisible();
    
    // ã™ã¹ã¦ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–è¦ç´ ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã§ãã‚‹ã“ã¨ã‚’ç¢ºèª
    const interactiveElements = await page.locator('a, button, [tabindex="0"]').count();
    
    for (let i = 0; i < interactiveElements; i++) {
      await page.keyboard.press('Tab');
      focused = await page.locator(':focus');
      await expect(focused).toBeVisible();
    }
  });
  
  test('Enterã‚­ãƒ¼ã§ãƒœã‚¿ãƒ³ã‚’æŠ¼ã›ã‚‹', async ({ page }) => {
    await page.goto('http://localhost:5173');
    
    // ãƒœã‚¿ãƒ³ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
    await page.locator('button:has-text("ä»Šæ—¥ã®ä¸€èªã‚’å¼•ã")').focus();
    
    // Enterã‚­ãƒ¼ã§å®Ÿè¡Œ
    await page.keyboard.press('Enter');
    
    // ã‚«ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    await expect(page.locator('.entry-card')).toBeVisible();
  });
});
```

#### CI/CDã§ã®å®Ÿè¡Œ

```yaml
# .github/workflows/test.yml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - uses: pnpm/action-setup@v2
        with:
          version: 8
      
      - name: Install dependencies
        run: pnpm install
      
      - name: Run unit tests
        run: pnpm test
      
      - name: Build
        run: pnpm build
      
      - name: Install Playwright browsers
        run: pnpm playwright install --with-deps
      
      - name: Run E2E tests
        run: pnpm playwright test
      
      - name: Upload test results
        if: failure()
        uses: actions/upload-artifact@v4
        with:
          name: playwright-report
          path: playwright-report/
```

#### é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

1. **ãƒ†ã‚¹ãƒˆã®ãƒãƒ©ãƒ³ã‚¹** ğŸ¯
   - ã™ã¹ã¦ã‚’E2Eã§ãƒ†ã‚¹ãƒˆã—ãªã„ï¼ˆé…ã„ãƒ»å£Šã‚Œã‚„ã™ã„ï¼‰
   - **é‡è¦ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼**ã ã‘E2Eãƒ†ã‚¹ãƒˆ
   - ç´°ã‹ã„ãƒ­ã‚¸ãƒƒã‚¯ã¯å˜ä½“ãƒ†ã‚¹ãƒˆ

2. **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã®é™ç•Œ** âš ï¸
   - è‡ªå‹•æ¤œå‡ºã§ãã‚‹ã®ã¯ç´„57%
   - æ®‹ã‚Š43%ã¯æ‰‹å‹•ãƒã‚§ãƒƒã‚¯ãŒå¿…è¦
   - ã§ã‚‚57%ã§ã‚‚ååˆ†ä¾¡å€¤ãŒã‚ã‚‹ï¼

3. **ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆ** ğŸŒ
   - Chromiumã€Firefoxã€WebKitã§è‡ªå‹•ãƒ†ã‚¹ãƒˆ
   - playwright.config.tsã§è¨­å®š

4. **å®Ÿè£…ã‚³ã‚¹ãƒˆã¯å°ã•ã„** ğŸ’
   - ã“ã®ã‚¢ãƒ—ãƒªãªã‚‰10ã€œ15ã‚±ãƒ¼ã‚¹ï¼ˆ1ã€œ2æ—¥ï¼‰
   - ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã¨ã—ã¦ã®å®Œæˆåº¦ãŒé«˜ã¾ã‚‹ï¼

#### ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã®èª¬æ˜æ–¹æ³•

> ã€Œå“è³ªã‚’é‡è¦–ã—ã¦**3å±¤ã®ãƒ†ã‚¹ãƒˆæˆ¦ç•¥**ã‚’æ¡ç”¨ã—ã¾ã—ãŸã€‚
> 
> 1. **Vitest**ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ã®å˜ä½“ãƒ†ã‚¹ãƒˆ
> 2. **Playwright**ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼ã®E2Eãƒ†ã‚¹ãƒˆ
> 3. **axe-core**ã§WCAG 2.2 AAæº–æ‹ ã‚’è‡ªå‹•æ¤œè¨¼
> 
> Playwrightã¨CI/CDã®é€£æºã§ã€**ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆã¨ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ã‚’è‡ªå‹•åŒ–**ã—ã€å“è³ªé‡è¦–ã®é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿè·µã—ã¾ã—ãŸã€‚ã€

---

## ã¾ã¨ã‚

ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã†ã“ã¨ã§ï¼š
- âœ… **å“è³ªã®é«˜ã„ã‚³ãƒ¼ãƒ‰**ãŒæ›¸ã‘ã‚‹
- âœ… **å¤‰æ›´ã«å¼·ã„è¨­è¨ˆ**ã«ãªã‚‹
- âœ… **ãƒãƒ¼ãƒ é–‹ç™º**ãŒã‚¹ãƒ ãƒ¼ã‚ºã«ãªã‚‹
- âœ… **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**ãŒæ¥½ã«ãªã‚‹

æœ€åˆã¯å¤§å¤‰ã‹ã‚‚ã—ã‚Œãªã„ã‘ã©ã€æ…£ã‚Œã‚Œã°è‡ªç„¶ã«æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚‹ã‚ˆï¼ğŸ‰

**å›°ã£ãŸã¨ãã¯ã€ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¦‹è¿”ã—ã¦ã­ï¼ğŸ“–**